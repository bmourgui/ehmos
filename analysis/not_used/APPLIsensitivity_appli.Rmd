---
title: "Sensitivity analysis on application data"
author: "Mourguiart, Bastien"
date: "23/11/2020"
output: pdf_document
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```

# Tol 
## Period 1
```{r tol, fig.show='hide', message=FALSE, warning=FALSE, include=FALSE, paged.print=FALSE}
library(knitr)
library(lattice)
library(dplyr)
library(kableExtra)

load("~/Bureau/PhD/Orthoptera/CC/Analysis/Application_analysis/Results_data/appli_data.RData")
alti <- alti_appli
load("~/Bureau/PhD/Orthoptera/CC/Analysis/Application_analysis/Results_data/out_application.RData") #first run of the application, with usual priors and convergence problem for tau.tol
load("~/Bureau/PhD/Orthoptera/CC/Analysis/Application_analysis/Results_data/out_appli_jamil.RData")
out <- out_appli_jamil
load("~/Bureau/PhD/Orthoptera/CC/Analysis/Application_analysis/Results_data/out_appli_jamil_sensi1.RData") #second run with usual priors, no convergence issue
load("~/Bureau/PhD/Orthoptera/CC/Analysis/Application_analysis/Results_data/out_appli_jamil_sensi2.RData") #run with my own priors, 'more informative' but with the same form (normal for mu's and gamma for tau's)
load("~/Bureau/PhD/Orthoptera/CC/Analysis/Application_analysis/Results_data/out_appli_jamil_sensi3.RData")

#saving outputs within objects with smaller names
out1 <- out_appli_jamil_sensi1
out2 <- out_appli_jamil_sensi2
out3 <- out_appli_jamil_sensi3


plot(as.numeric(out$samples[[1]][,"tol.mean[1]"])*sd(alti), type="l", main="", xlab="Iterations", ylab="")
lines(as.numeric(out$samples[[2]][,"tol.mean[1]"])*sd(alti), col="red")
lines(as.numeric(out$samples[[3]][,"tol.mean[1]"])*sd(alti), col="green")
plot(as.numeric(out1$samples[[1]][,"tol.mean[1]"]), type="l", main="", xlab="Iterations", ylab="")
lines(as.numeric(out1$samples[[2]][,"tol.mean[1]"]), col="red")
lines(as.numeric(out1$samples[[3]][,"tol.mean[1]"]), col="green")
plot(as.numeric(out2$samples[[1]][,"tol.mean[1]"]), type="l", main="", xlab="Iterations", ylab="")
lines(as.numeric(out2$samples[[2]][,"tol.mean[1]"]), col="red")
lines(as.numeric(out2$samples[[3]][,"tol.mean[1]"]), col="green")
plot(as.numeric(out3$samples[[1]][,"tol.mean[1]"]), type="l", main="", xlab="Iterations", ylab="")
lines(as.numeric(out3$samples[[2]][,"tol.mean[1]"]), col="red")
lines(as.numeric(out3$samples[[3]][,"tol.mean[1]"]), col="green")
```




```{r tolB, fig.show = "hide", fig.height=3, fig.width=5}


# generate plots
tble_tol1 <- data.frame("Prior"=c("Flat Prior: \n N(0, 1000)", "Compared to: \n N(330,70^2)", "Compared to: \n N(330,(70^2)*5)", "Compared to: \n N(330,(70^2)*10)"), 
             "Estimate"=c(paste(round(mean(out$sims.list$tol.mean[,1]*sd(alti)),2),"(", round(sd(out$sims.list$tol.mean[,1]*sd(alti)),2), ")"), paste(round(mean(out1$sims.list$tol.mean[,1]),2),"(", round(sd(out1$sims.list$tol.mean[,1]),2), ")"),paste(round(mean(out2$sims.list$tol.mean[,1]),2),"(", round(sd(out2$sims.list$tol.mean[,1]),2), ")"), paste(round(mean(out3$sims.list$tol.mean[,1]),2),"(", round(sd(out3$sims.list$tol.mean[,1]),2), ")")), 
            "Plot"="",
             "Size"=c("",
               paste(round(100*(mean(out$sims.list$tol.mean[,1]*sd(alti))-mean(out1$sims.list$tol.mean[,1]))/mean(out$sims.list$tol.mean[,1]*sd(alti)),2), "%", sep=""),
               paste(round(100*(mean(out$sims.list$tol.mean[,1]*sd(alti))-mean(out2$sims.list$tol.mean[,1]))/mean(out$sims.list$tol.mean[,1]*sd(alti)),2), "%", sep=""),
              paste(round(100*(mean(out$sims.list$tol.mean[,1]*sd(alti))-mean(out3$sims.list$tol.mean[,1]))/mean(out$sims.list$tol.mean[,1]*sd(alti)),2), "%", sep="")))


kbl(tble_tol1, col.names = c("Chain comparison", "Estimate\n(SD)", "Trace Plot", "Size of Effect"), align = "l", format="latex", booktabs=TRUE, escape = T) %>%
  column_spec(3,image=spec_image(paste0(opts_chunk$get("fig.path"), "tol-", 1:4, ".pdf"), width=600, height=300))
```


## Period 2
```{r tol2, fig.show='hide', fig.height=3, fig.width=5}

plot(as.numeric(out$samples[[1]][,"tol.mean[2]"])*sd(alti), type="l", main="", xlab="Iterations", ylab="")
lines(as.numeric(out$samples[[2]][,"tol.mean[2]"])*sd(alti), col="red")
lines(as.numeric(out$samples[[3]][,"tol.mean[2]"])*sd(alti), col="green")
plot(as.numeric(out1$samples[[1]][,"tol.mean[2]"]), type="l", main="", xlab="Iterations", ylab="")
lines(as.numeric(out1$samples[[2]][,"tol.mean[2]"]), col="red")
lines(as.numeric(out1$samples[[3]][,"tol.mean[2]"]), col="green")
plot(as.numeric(out2$samples[[1]][,"tol.mean[2]"]), type="l", main="", xlab="Iterations", ylab="")
lines(as.numeric(out2$samples[[2]][,"tol.mean[2]"]), col="red")
lines(as.numeric(out2$samples[[3]][,"tol.mean[2]"]), col="green")
plot(as.numeric(out3$samples[[1]][,"tol.mean[2]"]), type="l", main="", xlab="Iterations", ylab="")
lines(as.numeric(out3$samples[[2]][,"tol.mean[2]"]), col="red")
lines(as.numeric(out3$samples[[3]][,"tol.mean[2]"]), col="green")
```



```{r tol2B, fig.show = "hide", fig.height=3, fig.width=5}

tble_tol1 <- cbind(c("Flat Prior: \n N(0, 1000)", "Compared to: \n N(330,70^2)", "Compared to: \n N(330,(70^2)*5)", "Compared to: \n N(330,(70^2)*10)"), 
             c(paste(round(mean(out$sims.list$tol.mean[,2]*sd(alti)),2),"(", round(sd(out$sims.list$tol.mean[,2]*sd(alti)),2), ")"), paste(round(mean(out1$sims.list$tol.mean[,2]),2),"(", round(sd(out1$sims.list$tol.mean[,2]),2), ")"),paste(round(mean(out2$sims.list$tol.mean[,2]),2),"(", round(sd(out2$sims.list$tol.mean[,2]),2), ")"), paste(round(mean(out3$sims.list$tol.mean[,2]),2),"(", round(sd(out3$sims.list$tol.mean[,2]),2), ")")), 
             "",
             c("",
               paste(round(100*(mean(out$sims.list$tol.mean[,2]*sd(alti))-mean(out1$sims.list$tol.mean[,2]))/mean(out$sims.list$tol.mean[,2]*sd(alti)),2), "%", sep=""),
               paste(round(100*(mean(out$sims.list$tol.mean[,2]*sd(alti))-mean(out2$sims.list$tol.mean[,2]))/mean(out$sims.list$tol.mean[,2]*sd(alti)),2), "%", sep=""),
              paste(round(100*(mean(out$sims.list$tol.mean[,2]*sd(alti))-mean(out3$sims.list$tol.mean[,2]))/mean(out$sims.list$tol.mean[,2]*sd(alti)),2), "%", sep="")))
kable(tble_tol1, col.names = c("Chain comparison", "Estimate (SD)", "Trace Plot", "Size of Effect"), align = "l", format="latex", booktabs=TRUE) %>%
  column_spec(3,image=spec_image(paste0(opts_chunk$get("fig.path"), "tol2-", 1:4, ".pdf"), width=600, height=300))
```

# Alpha
## Period 1

```{r alpha, fig.height=3, fig.show="hide", fig.width=5}


plot(as.numeric(out$samples[[1]][,"alpha.mean[1]"]), type="l", main="", xlab="Iterations", ylab="")
lines(as.numeric(out$samples[[2]][,"alpha.mean[1]"]), col="red")
lines(as.numeric(out$samples[[3]][,"alpha.mean[1]"]), col="green")
plot(as.numeric(out1$samples[[1]][,"alpha.mean[1]"]), type="l", main="", xlab="Iterations", ylab="")
lines(as.numeric(out1$samples[[2]][,"alpha.mean[1]"]), col="red")
lines(as.numeric(out1$samples[[3]][,"alpha.mean[1]"]), col="green")
plot(as.numeric(out2$samples[[1]][,"alpha.mean[1]"]), type="l", main="", xlab="Iterations", ylab="")
lines(as.numeric(out2$samples[[2]][,"alpha.mean[1]"]), col="red")
lines(as.numeric(out2$samples[[3]][,"alpha.mean[1]"]), col="green")
plot(as.numeric(out3$samples[[1]][,"alpha.mean[1]"]), type="l", main="", xlab="Iterations", ylab="")
lines(as.numeric(out3$samples[[2]][,"alpha.mean[1]"]), col="red")
lines(as.numeric(out3$samples[[3]][,"alpha.mean[1]"]), col="green")
```




```{r alphaB, fig.height=3, fig.show="hide", fig.width=5}
library(knitr)
library(kableExtra)

# generate plots
tble_alpha1 <- cbind(c("Flat Prior: \n N(0, 1000)", "Compared to: \n logit(N(0.47,0.27^2))", "Compared to: \n logit(N(0.47,(0.27^2)*5))", "Compared to: \n logit(N(0.47,(0.27^2)*10))"), 
             c(paste(round(mean(out$sims.list$alpha.mean[,1]),2),"(", round(sd(out$sims.list$alpha.mean[,1]),2), ")"), paste(round(mean(out1$sims.list$alpha.mean[,1]),2),"(", round(sd(out1$sims.list$alpha.mean[,1]),2), ")"),paste(round(mean(out2$sims.list$alpha.mean[,1]),2),"(", round(sd(out2$sims.list$alpha.mean[,1]),2), ")"), paste(round(mean(out3$sims.list$alpha.mean[,1]),2),"(", round(sd(out3$sims.list$alpha.mean[,1]),2), ")")), 
             "",
             c("",
               paste(round(100*(mean(out$sims.list$alpha.mean[,1])-mean(out1$sims.list$alpha.mean[,1]))/mean(out$sims.list$alpha.mean[,1]),2), "%", sep=""),
               paste(round(100*(mean(out$sims.list$alpha.mean[,1])-mean(out2$sims.list$alpha.mean[,1]))/mean(out$sims.list$alpha.mean[,1]),2), "%", sep=""),
              paste(round(100*(mean(out$sims.list$alpha.mean[,1])-mean(out3$sims.list$alpha.mean[,1]))/mean(out$sims.list$alpha.mean[,1]),2), "%", sep="")))
kable(tble_alpha1, col.names = c("Chain comparison", "Estimate (SD)", "Trace Plot", "Size of Effect"), align = "l", format="latex", booktabs=TRUE) %>%
  column_spec(3,image=spec_image(paste0(opts_chunk$get("fig.path"), "alpha-", 1:4, ".pdf"), width=600, height=300))
```


## Period 2

```{r alpha2, fig.height=3, fig.show="hide", fig.width=5}


plot(as.numeric(out$samples[[1]][,"alpha.mean[2]"]), type="l", main="", xlab="Iterations", ylab="")
lines(as.numeric(out$samples[[2]][,"alpha.mean[2]"]), col="red")
lines(as.numeric(out$samples[[3]][,"alpha.mean[2]"]), col="green")
plot(as.numeric(out1$samples[[1]][,"alpha.mean[2]"]), type="l", main="", xlab="Iterations", ylab="")
lines(as.numeric(out1$samples[[2]][,"alpha.mean[2]"]), col="red")
lines(as.numeric(out1$samples[[3]][,"alpha.mean[2]"]), col="green")
plot(as.numeric(out2$samples[[1]][,"alpha.mean[2]"]), type="l", main="", xlab="Iterations", ylab="")
lines(as.numeric(out2$samples[[2]][,"alpha.mean[2]"]), col="red")
lines(as.numeric(out2$samples[[3]][,"alpha.mean[2]"]), col="green")
plot(as.numeric(out3$samples[[1]][,"alpha.mean[2]"]), type="l", main="", xlab="Iterations", ylab="")
lines(as.numeric(out3$samples[[2]][,"alpha.mean[2]"]), col="red")
lines(as.numeric(out3$samples[[3]][,"alpha.mean[2]"]), col="green")
```




```{r alpha2B, fig.height=3, fig.show="hide", fig.width=5}
library(knitr)
library(kableExtra)

# generate plots
tble_alpha2 <- cbind(c("Flat Prior: \n N(0, 1000)", "Compared to: \n logit(N(0.47,0.27^2))", "Compared to: \n logit(N(0.47,(0.27^2)*5))", "Compared to: \n logit(N(0.47,(0.27^2)*10))"), 
             c(paste(round(mean(out$sims.list$alpha.mean[,2]),2),"(", round(sd(out$sims.list$alpha.mean[,2]),2), ")"), paste(round(mean(out1$sims.list$alpha.mean[,2]),2),"(", round(sd(out1$sims.list$alpha.mean[,2]),2), ")"),paste(round(mean(out2$sims.list$alpha.mean[,2]),2),"(", round(sd(out2$sims.list$alpha.mean[,2]),2), ")"), paste(round(mean(out3$sims.list$alpha.mean[,2]),2),"(", round(sd(out3$sims.list$alpha.mean[,2]),2), ")")), 
             "",
             c("",
               paste(round(100*(mean(out$sims.list$alpha.mean[,2])-mean(out1$sims.list$alpha.mean[,2]))/mean(out$sims.list$alpha.mean[,2]),2), "%", sep=""),
               paste(round(100*(mean(out$sims.list$alpha.mean[,2])-mean(out2$sims.list$alpha.mean[,2]))/mean(out$sims.list$alpha.mean[,2]),2), "%", sep=""),
              paste(round(100*(mean(out$sims.list$alpha.mean[,2])-mean(out3$sims.list$alpha.mean[,2]))/mean(out$sims.list$alpha.mean[,2]),2), "%", sep="")))
kable(tble_alpha2, col.names = c("Chain comparison", "Estimate (SD)", "Trace Plot", "Size of Effect"), align = "l", format="latex", booktabs=TRUE) %>%
  column_spec(3,image=spec_image(paste0(opts_chunk$get("fig.path"), "alpha2-", 1:4, ".pdf"), width=600, height=300))
```


# Optimum

```{r opt, fig.show='hide', fig.height=3, fig.width=5}


plot(as.numeric(out$samples[[1]][,"opt.mean"])*sd(alti)+mean(alti), type="l", main="", xlab="Iterations", ylab="")
lines(as.numeric(out$samples[[2]][,"opt.mean"])*sd(alti)+mean(alti), col="red")
lines(as.numeric(out$samples[[3]][,"opt.mean"])*sd(alti)+mean(alti), col="green")
plot(as.numeric(out1$samples[[1]][,"opt.mean"]), type="l", main="", xlab="Iterations", ylab="")
lines(as.numeric(out1$samples[[2]][,"opt.mean"]), col="red")
lines(as.numeric(out1$samples[[3]][,"opt.mean"]), col="green")
plot(as.numeric(out2$samples[[1]][,"opt.mean"]), type="l", main="", xlab="Iterations", ylab="")
lines(as.numeric(out2$samples[[2]][,"opt.mean"]), col="red")
lines(as.numeric(out2$samples[[3]][,"opt.mean"]), col="green")
plot(as.numeric(out3$samples[[1]][,"opt.mean"]), type="l", main="", xlab="Iterations", ylab="")
lines(as.numeric(out3$samples[[2]][,"opt.mean"]), col="red")
lines(as.numeric(out3$samples[[3]][,"opt.mean"]), col="green")
```




```{r optB, fig.show = "hide", fig.height=3, fig.width=5}
library(knitr)
library(kableExtra)

# generate plots
tble_opt <- cbind(c("Flat Prior: \n N(0, 1000)", "Compared to: \n N(1800,240^2)", "Compared to: \n N(1800,(240^2)*5)", "Compared to: \n N(1800,(240^2)*10)"), 
             c(paste(round(mean(out$sims.list$opt.mean*sd(alti)+mean(alti)),2),"(", round(sd(out$sims.list$opt.mean*sd(alti)+mean(alti)),2), ")"), paste(round(mean(out1$sims.list$opt.mean),2),"(", round(sd(out1$sims.list$opt.mean),2), ")"),paste(round(mean(out2$sims.list$opt.mean),2),"(", round(sd(out2$sims.list$opt.mean),2), ")"), paste(round(mean(out3$sims.list$opt.mean),2),"(", round(sd(out3$sims.list$opt.mean),2), ")")), 
             "",
             c("",
               paste(round(100*(mean(out$sims.list$opt.mean*sd(alti)+mean(alti))-mean(out1$sims.list$opt.mean))/mean(out$sims.list$opt.mean*sd(alti)+mean(alti)),2), "%", sep=""),
               paste(round(100*(mean(out$sims.list$opt.mean*sd(alti)+mean(alti))-mean(out2$sims.list$opt.mean))/mean(out$sims.list$opt.mean*sd(alti)+mean(alti)),2), "%", sep=""),
              paste(round(100*(mean(out$sims.list$opt.mean*sd(alti)+mean(alti))-mean(out3$sims.list$opt.mean))/mean(out$sims.list$opt.mean*sd(alti)+mean(alti)),2), "%", sep="")))
kable(tble_opt, col.names = c("Chain comparison", "Estimate (SD)", "Trace Plot", "Size of Effect"), align = "l", format="latex", booktabs=TRUE) %>%
  column_spec(3,image=spec_image(paste0(opts_chunk$get("fig.path"), "opt-", 1:4, ".pdf"), width=600, height=300))
```




# Shift

```{r shift, fig.show='hide', fig.height=3, fig.width=5}


plot(as.numeric(out$samples[[1]][,"shift.mean"])*sd(alti), type="l", main="", xlab="Iterations", ylab="")
lines(as.numeric(out$samples[[2]][,"shift.mean"])*sd(alti), col="red")
lines(as.numeric(out$samples[[3]][,"shift.mean"])*sd(alti), col="green")
plot(as.numeric(out1$samples[[1]][,"shift.mean"]), type="l", main="", xlab="Iterations", ylab="")
lines(as.numeric(out1$samples[[2]][,"shift.mean"]), col="red")
lines(as.numeric(out1$samples[[3]][,"shift.mean"]), col="green")
plot(as.numeric(out2$samples[[1]][,"shift.mean"]), type="l", main="", xlab="Iterations", ylab="")
lines(as.numeric(out2$samples[[2]][,"shift.mean"]), col="red")
lines(as.numeric(out2$samples[[3]][,"shift.mean"]), col="green")
plot(as.numeric(out3$samples[[1]][,"shift.mean"]), type="l", main="", xlab="Iterations", ylab="")
lines(as.numeric(out3$samples[[2]][,"shift.mean"]), col="red")
lines(as.numeric(out3$samples[[3]][,"shift.mean"]), col="green")
```




```{r shiftB, fig.show = "hide", fig.height=3, fig.width=5}
library(knitr)
library(kableExtra)

# generate plots
tble_shift2 <- cbind(c("Flat Prior: \n \n N(0, 1000)", "Compared to: \n N(120,100^2)", "Compared to: \n N(120,(100^2)*5)", "Compared to: \n N(120,(100^2)*10)"), 
             c(paste(round(mean(out$sims.list$shift.mean*sd(alti)),2),"(", round(sd(out$sims.list$shift.mean*sd(alti)),2), ")"), paste(round(mean(out1$sims.list$shift.mean),2),"(", round(sd(out1$sims.list$shift.mean),2), ")"),paste(round(mean(out2$sims.list$shift.mean),2),"(", round(sd(out2$sims.list$shift.mean),2), ")"), paste(round(mean(out3$sims.list$shift.mean),2),"(", round(sd(out3$sims.list$shift.mean),2), ")")), 
             "",
             c("",
               paste(round(100*(mean(out$sims.list$shift.mean*sd(alti))-mean(out1$sims.list$shift.mean))/mean(out$sims.list$shift.mean*sd(alti)),2), "%", sep=""),
               paste(round(100*(mean(out$sims.list$shift.mean*sd(alti))-mean(out2$sims.list$shift.mean))/mean(out$sims.list$shift.mean*sd(alti)),2), "%", sep=""),
              paste(round(100*(mean(out$sims.list$shift.mean*sd(alti))-mean(out3$sims.list$shift.mean))/mean(out$sims.list$shift.mean*sd(alti)),2), "%", sep="")))
kable(tble_shift2, col.names = c("Chain comparison", "Estimate (SD)", "Trace Plot", "Size of Effect"), align = "l", format="latex", booktabs=TRUE) %>%
  column_spec(3,image=spec_image(paste0(opts_chunk$get("fig.path"), "shift-", 1:4, ".pdf"), width=600, height=300))
```

























# With alti scaled

First set of prior was the same as in Jamil *et al.* (2014), used for an environmental variable scaled to have mean 0 and standard-deviation equal to 1. The three other sets were based on what we know about ecology of orthoptera. Values for the hyperparameters were set in the real scale and then transform to match with the variable scaled. For example, the mean optimum at the community level is assumed to follow a normal distribution with mean 1800 and standard deviation 240, in the real scale. These values were scaled: $\mu_{theta} \sim N(-0.48, (-4.9)^2)$. Hence, the mean value for the normal is fixed for all sets, and standard deviation increased proportionally at each set.

# Tol 
## Period 1
```{r tol_sc, fig.show='hide', message=FALSE, warning=FALSE, include=FALSE, paged.print=FALSE}
library(knitr)
library(lattice)
library(dplyr)
library(kableExtra)

load("~/Bureau/PhD/Orthoptera/CC/Analysis/Application_analysis/Results_data/out_appli_jamil_sensi1_scaled.RData") #second run with usual priors, no convergence issue
load("~/Bureau/PhD/Orthoptera/CC/Analysis/Application_analysis/Results_data/out_appli_jamil_sensi2_scaled.RData") #run with my own priors, 'more informative' but with the same form (normal for mu's and gamma for tau's)
load("~/Bureau/PhD/Orthoptera/CC/Analysis/Application_analysis/Results_data/out_appli_jamil_sensi3_scaled.RData")

#saving outputs within objects with smaller names
out1 <- out_appli_jamil_sensi1_scaled
out2 <- out_appli_jamil_sensi2_scaled
out3 <- out_appli_jamil_sensi3_scaled


plot(as.numeric(out$samples[[1]][,"tol.mean[1]"]), type="l", main="", xlab="Iterations", ylab="")
lines(as.numeric(out$samples[[2]][,"tol.mean[1]"]), col="red")
lines(as.numeric(out$samples[[3]][,"tol.mean[1]"]), col="green")
plot(as.numeric(out1$samples[[1]][,"tol.mean[1]"]), type="l", main="", xlab="Iterations", ylab="")
lines(as.numeric(out1$samples[[2]][,"tol.mean[1]"]), col="red")
lines(as.numeric(out1$samples[[3]][,"tol.mean[1]"]), col="green")
plot(as.numeric(out2$samples[[1]][,"tol.mean[1]"]), type="l", main="", xlab="Iterations", ylab="")
lines(as.numeric(out2$samples[[2]][,"tol.mean[1]"]), col="red")
lines(as.numeric(out2$samples[[3]][,"tol.mean[1]"]), col="green")
plot(as.numeric(out3$samples[[1]][,"tol.mean[1]"]), type="l", main="", xlab="Iterations", ylab="")
lines(as.numeric(out3$samples[[2]][,"tol.mean[1]"]), col="red")
lines(as.numeric(out3$samples[[3]][,"tol.mean[1]"]), col="green")
```




```{r tolB_sc, fig.show = "hide", fig.height=3, fig.width=5}


# generate plots
tble_tol1 <- data.frame("Prior"=c("Flat Prior: \n N(0, 1000)", "Compared to: \n N(0.93,0.19^2)", "Compared to: \n N(0.93,(0.19^2)*5)", "Compared to: \n N(0.93,(0.19^2)*10)"), 
             "Estimate"=c(paste(round(mean(out$sims.list$tol.mean[,1]),2),"(", round(sd(out$sims.list$tol.mean[,1]),2), ")"), paste(round(mean(out1$sims.list$tol.mean[,1]),2),"(", round(sd(out1$sims.list$tol.mean[,1]),2), ")"),paste(round(mean(out2$sims.list$tol.mean[,1]),2),"(", round(sd(out2$sims.list$tol.mean[,1]),2), ")"), paste(round(mean(out3$sims.list$tol.mean[,1]),2),"(", round(sd(out3$sims.list$tol.mean[,1]),2), ")")), 
            "Plot"="",
             "Size"=c("",
               paste(round(100*(mean(out$sims.list$tol.mean[,1])-mean(out1$sims.list$tol.mean[,1]))/mean(out$sims.list$tol.mean[,1]),2), "%", sep=""),
               paste(round(100*(mean(out$sims.list$tol.mean[,1])-mean(out2$sims.list$tol.mean[,1]))/mean(out$sims.list$tol.mean[,1]),2), "%", sep=""),
              paste(round(100*(mean(out$sims.list$tol.mean[,1])-mean(out3$sims.list$tol.mean[,1]))/mean(out$sims.list$tol.mean[,1]),2), "%", sep="")))


kbl(tble_tol1, col.names = c("Chain comparison", "Estimate\n(SD)", "Trace Plot", "Size of Effect"), align = "l", format="latex", booktabs=TRUE, escape = T) %>%
  column_spec(3,image=spec_image(paste0(opts_chunk$get("fig.path"), "tol_sc-", 1:4, ".pdf"), width=600, height=300))
```


## Period 2
```{r tol2_sc, fig.show='hide', fig.height=3, fig.width=5}

plot(as.numeric(out$samples[[1]][,"tol.mean[2]"]), type="l", main="", xlab="Iterations", ylab="")
lines(as.numeric(out$samples[[2]][,"tol.mean[2]"]), col="red")
lines(as.numeric(out$samples[[3]][,"tol.mean[2]"]), col="green")
plot(as.numeric(out1$samples[[1]][,"tol.mean[2]"]), type="l", main="", xlab="Iterations", ylab="")
lines(as.numeric(out1$samples[[2]][,"tol.mean[2]"]), col="red")
lines(as.numeric(out1$samples[[3]][,"tol.mean[2]"]), col="green")
plot(as.numeric(out2$samples[[1]][,"tol.mean[2]"]), type="l", main="", xlab="Iterations", ylab="")
lines(as.numeric(out2$samples[[2]][,"tol.mean[2]"]), col="red")
lines(as.numeric(out2$samples[[3]][,"tol.mean[2]"]), col="green")
plot(as.numeric(out3$samples[[1]][,"tol.mean[2]"]), type="l", main="", xlab="Iterations", ylab="")
lines(as.numeric(out3$samples[[2]][,"tol.mean[2]"]), col="red")
lines(as.numeric(out3$samples[[3]][,"tol.mean[2]"]), col="green")
```



```{r tol2B_sc, fig.show = "hide", fig.height=3, fig.width=5}

tble_tol1 <- cbind(c("Flat Prior: \n N(0, 1000)", "Compared to: \n N(0.93,0.19^2)", "Compared to: \n N(0.93,(0.19^2)*5)", "Compared to: \n N(0.93,(0.19^2)*10)"), 
             c(paste(round(mean(out$sims.list$tol.mean[,2]),2),"(", round(sd(out$sims.list$tol.mean[,2]),2), ")"), paste(round(mean(out1$sims.list$tol.mean[,2]),2),"(", round(sd(out1$sims.list$tol.mean[,2]),2), ")"),paste(round(mean(out2$sims.list$tol.mean[,2]),2),"(", round(sd(out2$sims.list$tol.mean[,2]),2), ")"), paste(round(mean(out3$sims.list$tol.mean[,2]),2),"(", round(sd(out3$sims.list$tol.mean[,2]),2), ")")), 
             "",
             c("",
               paste(round(100*(mean(out$sims.list$tol.mean[,2])-mean(out1$sims.list$tol.mean[,2]))/mean(out$sims.list$tol.mean[,2]),2), "%", sep=""),
               paste(round(100*(mean(out$sims.list$tol.mean[,2])-mean(out2$sims.list$tol.mean[,2]))/mean(out$sims.list$tol.mean[,2]),2), "%", sep=""),
              paste(round(100*(mean(out$sims.list$tol.mean[,2])-mean(out3$sims.list$tol.mean[,2]))/mean(out$sims.list$tol.mean[,2]),2), "%", sep="")))
kable(tble_tol1, col.names = c("Chain comparison", "Estimate (SD)", "Trace Plot", "Size of Effect"), align = "l", format="latex", booktabs=TRUE) %>%
  column_spec(3,image=spec_image(paste0(opts_chunk$get("fig.path"), "tol2_sc-", 1:4, ".pdf"), width=600, height=300))
```

# Alpha
## Period 1

```{r alpha_sc, fig.height=3, fig.show="hide", fig.width=5}


plot(as.numeric(out$samples[[1]][,"alpha.mean[1]"]), type="l", main="", xlab="Iterations", ylab="")
lines(as.numeric(out$samples[[2]][,"alpha.mean[1]"]), col="red")
lines(as.numeric(out$samples[[3]][,"alpha.mean[1]"]), col="green")
plot(as.numeric(out1$samples[[1]][,"alpha.mean[1]"]), type="l", main="", xlab="Iterations", ylab="")
lines(as.numeric(out1$samples[[2]][,"alpha.mean[1]"]), col="red")
lines(as.numeric(out1$samples[[3]][,"alpha.mean[1]"]), col="green")
plot(as.numeric(out2$samples[[1]][,"alpha.mean[1]"]), type="l", main="", xlab="Iterations", ylab="")
lines(as.numeric(out2$samples[[2]][,"alpha.mean[1]"]), col="red")
lines(as.numeric(out2$samples[[3]][,"alpha.mean[1]"]), col="green")
plot(as.numeric(out3$samples[[1]][,"alpha.mean[1]"]), type="l", main="", xlab="Iterations", ylab="")
lines(as.numeric(out3$samples[[2]][,"alpha.mean[1]"]), col="red")
lines(as.numeric(out3$samples[[3]][,"alpha.mean[1]"]), col="green")
```




```{r alphaB_sc, fig.height=3, fig.show="hide", fig.width=5}
library(knitr)
library(kableExtra)

# generate plots
tble_alpha1 <- cbind(c("Flat Prior: \n N(0, 1000)", "Compared to: \n logit(N(0.47,0.27^2))", "Compared to: \n logit(N(0.47,(0.27^2)*5))", "Compared to: \n logit(N(0.47,(0.27^2)*10))"), 
             c(paste(round(mean(out$sims.list$alpha.mean[,1]),2),"(", round(sd(out$sims.list$alpha.mean[,1]),2), ")"), paste(round(mean(out1$sims.list$alpha.mean[,1]),2),"(", round(sd(out1$sims.list$alpha.mean[,1]),2), ")"),paste(round(mean(out2$sims.list$alpha.mean[,1]),2),"(", round(sd(out2$sims.list$alpha.mean[,1]),2), ")"), paste(round(mean(out3$sims.list$alpha.mean[,1]),2),"(", round(sd(out3$sims.list$alpha.mean[,1]),2), ")")), 
             "",
             c("",
               paste(round(100*(mean(out$sims.list$alpha.mean[,1])-mean(out1$sims.list$alpha.mean[,1]))/mean(out$sims.list$alpha.mean[,1]),2), "%", sep=""),
               paste(round(100*(mean(out$sims.list$alpha.mean[,1])-mean(out2$sims.list$alpha.mean[,1]))/mean(out$sims.list$alpha.mean[,1]),2), "%", sep=""),
              paste(round(100*(mean(out$sims.list$alpha.mean[,1])-mean(out3$sims.list$alpha.mean[,1]))/mean(out$sims.list$alpha.mean[,1]),2), "%", sep="")))
kable(tble_alpha1, col.names = c("Chain comparison", "Estimate (SD)", "Trace Plot", "Size of Effect"), align = "l", format="latex", booktabs=TRUE) %>%
  column_spec(3,image=spec_image(paste0(opts_chunk$get("fig.path"), "alpha_sc-", 1:4, ".pdf"), width=600, height=300))
```


## Period 2

```{r alpha2_sc, fig.height=3, fig.show="hide", fig.width=5}


plot(as.numeric(out$samples[[1]][,"alpha.mean[2]"]), type="l", main="", xlab="Iterations", ylab="")
lines(as.numeric(out$samples[[2]][,"alpha.mean[2]"]), col="red")
lines(as.numeric(out$samples[[3]][,"alpha.mean[2]"]), col="green")
plot(as.numeric(out1$samples[[1]][,"alpha.mean[2]"]), type="l", main="", xlab="Iterations", ylab="")
lines(as.numeric(out1$samples[[2]][,"alpha.mean[2]"]), col="red")
lines(as.numeric(out1$samples[[3]][,"alpha.mean[2]"]), col="green")
plot(as.numeric(out2$samples[[1]][,"alpha.mean[2]"]), type="l", main="", xlab="Iterations", ylab="")
lines(as.numeric(out2$samples[[2]][,"alpha.mean[2]"]), col="red")
lines(as.numeric(out2$samples[[3]][,"alpha.mean[2]"]), col="green")
plot(as.numeric(out3$samples[[1]][,"alpha.mean[2]"]), type="l", main="", xlab="Iterations", ylab="")
lines(as.numeric(out3$samples[[2]][,"alpha.mean[2]"]), col="red")
lines(as.numeric(out3$samples[[3]][,"alpha.mean[2]"]), col="green")
```




```{r alpha2B_sc, fig.height=3, fig.show="hide", fig.width=5}
library(knitr)
library(kableExtra)

# generate plots
tble_alpha2 <- cbind(c("Flat Prior: \n N(0, 1000)", "Compared to: \n logit(N(0.47,0.27^2))", "Compared to: \n logit(N(0.47,(0.27^2)*5))", "Compared to: \n logit(N(0.47,(0.27^2)*10))"), 
             c(paste(round(mean(out$sims.list$alpha.mean[,2]),2),"(", round(sd(out$sims.list$alpha.mean[,2]),2), ")"), paste(round(mean(out1$sims.list$alpha.mean[,2]),2),"(", round(sd(out1$sims.list$alpha.mean[,2]),2), ")"),paste(round(mean(out2$sims.list$alpha.mean[,2]),2),"(", round(sd(out2$sims.list$alpha.mean[,2]),2), ")"), paste(round(mean(out3$sims.list$alpha.mean[,2]),2),"(", round(sd(out3$sims.list$alpha.mean[,2]),2), ")")), 
             "",
             c("",
               paste(round(100*(mean(out$sims.list$alpha.mean[,2])-mean(out1$sims.list$alpha.mean[,2]))/mean(out$sims.list$alpha.mean[,2]),2), "%", sep=""),
               paste(round(100*(mean(out$sims.list$alpha.mean[,2])-mean(out2$sims.list$alpha.mean[,2]))/mean(out$sims.list$alpha.mean[,2]),2), "%", sep=""),
              paste(round(100*(mean(out$sims.list$alpha.mean[,2])-mean(out3$sims.list$alpha.mean[,2]))/mean(out$sims.list$alpha.mean[,2]),2), "%", sep="")))
kable(tble_alpha2, col.names = c("Chain comparison", "Estimate (SD)", "Trace Plot", "Size of Effect"), align = "l", format="latex", booktabs=TRUE) %>%
  column_spec(3,image=spec_image(paste0(opts_chunk$get("fig.path"), "alpha2_sc-", 1:4, ".pdf"), width=600, height=300))
```


# Optimum

```{r opt_sc, fig.show='hide', fig.height=3, fig.width=5}


plot(as.numeric(out$samples[[1]][,"opt.mean"]), type="l", main="", xlab="Iterations", ylab="")
lines(as.numeric(out$samples[[2]][,"opt.mean"]), col="red")
lines(as.numeric(out$samples[[3]][,"opt.mean"]), col="green")
plot(as.numeric(out1$samples[[1]][,"opt.mean"]), type="l", main="", xlab="Iterations", ylab="")
lines(as.numeric(out1$samples[[2]][,"opt.mean"]), col="red")
lines(as.numeric(out1$samples[[3]][,"opt.mean"]), col="green")
plot(as.numeric(out2$samples[[1]][,"opt.mean"]), type="l", main="", xlab="Iterations", ylab="")
lines(as.numeric(out2$samples[[2]][,"opt.mean"]), col="red")
lines(as.numeric(out2$samples[[3]][,"opt.mean"]), col="green")
plot(as.numeric(out3$samples[[1]][,"opt.mean"]), type="l", main="", xlab="Iterations", ylab="")
lines(as.numeric(out3$samples[[2]][,"opt.mean"]), col="red")
lines(as.numeric(out3$samples[[3]][,"opt.mean"]), col="green")
```




```{r optB_sc, fig.show = "hide", fig.height=3, fig.width=5}
library(knitr)
library(kableExtra)

# generate plots
tble_opt <- cbind(c("Flat Prior: \n N(0, 1000)", "Compared to: \n N(-0.48,4.9^2)", "Compared to: \n N(-0.48,(4.9^2)*5)", "Compared to: \n N(-0.48,(4.9^2)*10)"), 
             c(paste(round(mean(out$sims.list$opt.mean),2),"(", round(sd(out$sims.list$opt.mean),2), ")"), paste(round(mean(out1$sims.list$opt.mean),2),"(", round(sd(out1$sims.list$opt.mean),2), ")"),paste(round(mean(out2$sims.list$opt.mean),2),"(", round(sd(out2$sims.list$opt.mean),2), ")"), paste(round(mean(out3$sims.list$opt.mean),2),"(", round(sd(out3$sims.list$opt.mean),2), ")")), 
             "",
             c("",
               paste(round(100*(mean(out$sims.list$opt.mean)-mean(out1$sims.list$opt.mean))/mean(out$sims.list$opt.mean),2), "%", sep=""),
               paste(round(100*(mean(out$sims.list$opt.mean)-mean(out2$sims.list$opt.mean))/mean(out$sims.list$opt.mean),2), "%", sep=""),
              paste(round(100*(mean(out$sims.list$opt.mean)-mean(out3$sims.list$opt.mean))/mean(out$sims.list$opt.mean),2), "%", sep="")))
kable(tble_opt, col.names = c("Chain comparison", "Estimate (SD)", "Trace Plot", "Size of Effect"), align = "l", format="latex", booktabs=TRUE) %>%
  column_spec(3,image=spec_image(paste0(opts_chunk$get("fig.path"), "opt_sc-", 1:4, ".pdf"), width=600, height=300))
```




# Shift

```{r shift_sc, fig.show='hide', fig.height=3, fig.width=5}


plot(as.numeric(out$samples[[1]][,"shift.mean"]), type="l", main="", xlab="Iterations", ylab="")
lines(as.numeric(out$samples[[2]][,"shift.mean"]), col="red")
lines(as.numeric(out$samples[[3]][,"shift.mean"]), col="green")
plot(as.numeric(out1$samples[[1]][,"shift.mean"]), type="l", main="", xlab="Iterations", ylab="")
lines(as.numeric(out1$samples[[2]][,"shift.mean"]), col="red")
lines(as.numeric(out1$samples[[3]][,"shift.mean"]), col="green")
plot(as.numeric(out2$samples[[1]][,"shift.mean"]), type="l", main="", xlab="Iterations", ylab="")
lines(as.numeric(out2$samples[[2]][,"shift.mean"]), col="red")
lines(as.numeric(out2$samples[[3]][,"shift.mean"]), col="green")
plot(as.numeric(out3$samples[[1]][,"shift.mean"]), type="l", main="", xlab="Iterations", ylab="")
lines(as.numeric(out3$samples[[2]][,"shift.mean"]), col="red")
lines(as.numeric(out3$samples[[3]][,"shift.mean"]), col="green")
```




```{r shiftB_sc, fig.show = "hide", fig.height=3, fig.width=5}
library(knitr)
library(kableExtra)

# generate plots
tble_shift2 <- cbind(c("Flat Prior: \n \n N(0, 1000)", "Compared to: \n N(0.34,0.28^2)", "Compared to: \n N(0.34,(0.28^2)*5)", "Compared to: \n N(0.34,(0.28^2)*10)"), 
             c(paste(round(mean(out$sims.list$shift.mean),2),"(", round(sd(out$sims.list$shift.mean),2), ")"), paste(round(mean(out1$sims.list$shift.mean),2),"(", round(sd(out1$sims.list$shift.mean),2), ")"),paste(round(mean(out2$sims.list$shift.mean),2),"(", round(sd(out2$sims.list$shift.mean),2), ")"), paste(round(mean(out3$sims.list$shift.mean),2),"(", round(sd(out3$sims.list$shift.mean),2), ")")), 
             "",
             c("",
               paste(round(100*(mean(out$sims.list$shift.mean)-mean(out1$sims.list$shift.mean))/mean(out$sims.list$shift.mean),2), "%", sep=""),
               paste(round(100*(mean(out$sims.list$shift.mean)-mean(out2$sims.list$shift.mean))/mean(out$sims.list$shift.mean),2), "%", sep=""),
              paste(round(100*(mean(out$sims.list$shift.mean)-mean(out3$sims.list$shift.mean))/mean(out$sims.list$shift.mean),2), "%", sep="")))
kable(tble_shift2, col.names = c("Chain comparison", "Estimate (SD)", "Trace Plot", "Size of Effect"), align = "l", format="latex", booktabs=TRUE) %>%
  column_spec(3,image=spec_image(paste0(opts_chunk$get("fig.path"), "shift_sc-", 1:4, ".pdf"), width=600, height=300))
```